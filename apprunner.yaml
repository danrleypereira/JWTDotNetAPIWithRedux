version: 1.0
runtime: dotnet6
build:
  commands:
    pre-build:
      - dotnet tool install --global dotnet-ef
      - dotnet clean
      - dotnet restore
    build:
      - dotnet build
      - dotnet ef database update --project DAL --startup-project karkarAPI
      - dotnet publish -c Release -o .karkarAPI/bin/Release/net6.0/publish
    post-build:
      - dotnet test
run:
  command: dotnet run --project karkarAPI/karkarAPI.csproj
  network: 
    port: 7247
    env: API_PORT
  env:
    - name: ASPNETCORE_URLS
      value: "https://*:7247"